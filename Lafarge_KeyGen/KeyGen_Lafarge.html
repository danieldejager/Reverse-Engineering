<html>
<head>
  <title>Evernote Export</title>
  <basefont face="Segoe UI" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/309091 (en-US, DDL); Windows/10.0.0 (Win64);"/>
  <style>
    body, td {
      font-family: Segoe UI;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="600"/>

<div>
<span><div><div><span style="font-weight: bold;">Crackme 3 - Write a KeyGen</span></div><div><br/></div><div><span style="font-weight: bold;"><img src="Evernote.enex_files/Image.png" type="image/png" data-filename="Image.png"/></span></div><div><br/></div><div><span style="font-weight: bold; text-decoration: underline;">IDA Pro</span></div><div><br/></div><div>The string Nope, thats not it - is actually the dialog that shows at the end for an incorrect password/username combination</div><div>I did step through the code and there are multiple for loops - so I'm assuming the username is transformed in such a way that it is encoded in some form</div><div>this implies that they keygen is basically needs a function to encode a username based on the principles/logic found in the assembly code</div><div><span style="font-weight: bold;">NOTE:</span>Â there is a constraint implemented, in that the username <span style="font-weight: bold;">must</span>Â be greater than 4 characters - anything less is a felony - love it or leave it - you better gain wait....da da da dadada da ðŸ™‚Â </div><div>I also noticed that every character that is added in the username textbox kicks off the debugger - so there is an event listening for adding characters in the textbox</div><div><br/></div><div><span style="font-weight: bold;"><img src="Evernote.enex_files/Image [1].png" type="image/png" data-filename="Image.png"/></span></div><div><br/></div><div>Added user daniel - size = 6 - the first for loop - loops 6 times - so this could be something like for(int i =0; i &lt; username.size; i++) { //do something }</div><div>then there is a second for loop that iterates 6 times, a third loop iterates 6 times, a fourth loop iterates 6 times, a fifth loop iterates 6 times, a sixth loop iterates 8 times, a seventh loop iterates 9 times</div><div><br/></div><div>just before we get the message that the stuff is incorrect there is are two function calls</div><div><br/></div><ol><li><div>lstrcpyA</div></li><li><div>lstrcmpA</div></li></ol><div><img src="Evernote.enex_files/Image [2].png" type="image/png" data-filename="Image.png"/></div><div><span style="font-weight: bold; text-decoration: underline;">lstrcpyA</span></div><ul><li><div>Copies a string to a buffer</div></li><li><div>They say this is a risky function to use because it can lead to a buffer overrun - that is nice to know ðŸ™‚ next time I see this I know I have a vulnerabilityÂ </div></li><li><div>Anyways, the return value is a pointer to the buffer - that is when the function succeeds - otherwise if the function fails it returns a NULL value and LpString1 may not be null-terminatedÂ </div></li></ul><div><br/></div><div><span style="font-style: italic; font-weight: bold; text-decoration: underline;">lstrcmpA</span></div><ul><li><div>lstrcmpA compares two character StringsÂ  - the comparison is case sensitiveÂ </div></li><li><div>the return value is an integerÂ </div></li><li><div><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(23, 23, 23); font-family: &quot;Segoe UI&quot;, SegoeUI, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">If the string pointed to by</span><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); color: rgb(23, 23, 23); font-family: &quot;Segoe UI&quot;, SegoeUI, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">Â </span><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); color: rgb(23, 23, 23); font-family: &quot;Segoe UI&quot;, SegoeUI, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-style: italic; font-variant-caps: normal; font-variant-ligatures: normal;">lpString1</span><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); color: rgb(23, 23, 23); font-family: &quot;Segoe UI&quot;, SegoeUI, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">Â </span><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); color: rgb(23, 23, 23); font-family: &quot;Segoe UI&quot;, SegoeUI, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">is less than the string pointed to by</span><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); color: rgb(23, 23, 23); font-family: &quot;Segoe UI&quot;, SegoeUI, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">Â </span><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); color: rgb(23, 23, 23); font-family: &quot;Segoe UI&quot;, SegoeUI, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-style: italic; font-variant-caps: normal; font-variant-ligatures: normal;">lpString2</span><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(23, 23, 23); font-family: &quot;Segoe UI&quot;, SegoeUI, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">, the return value is negative. If the string pointed to by</span><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); color: rgb(23, 23, 23); font-family: &quot;Segoe UI&quot;, SegoeUI, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">Â </span><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); color: rgb(23, 23, 23); font-family: &quot;Segoe UI&quot;, SegoeUI, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-style: italic; font-variant-caps: normal; font-variant-ligatures: normal;">lpString1</span><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); color: rgb(23, 23, 23); font-family: &quot;Segoe UI&quot;, SegoeUI, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">Â </span><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); color: rgb(23, 23, 23); font-family: &quot;Segoe UI&quot;, SegoeUI, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">is greater than the string pointed to by</span><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); color: rgb(23, 23, 23); font-family: &quot;Segoe UI&quot;, SegoeUI, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">Â </span><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); color: rgb(23, 23, 23); font-family: &quot;Segoe UI&quot;, SegoeUI, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-style: italic; font-variant-caps: normal; font-variant-ligatures: normal;">lpString2</span><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(23, 23, 23); font-family: &quot;Segoe UI&quot;, SegoeUI, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">, the return value is positive. If the strings are equal, the return value is zero.</span></div></li></ul><div><br/></div><div><span style="font-weight: bold;">Strategy:</span> I need to find the values that are being compared i.e. lpString2 and lpString1 - one of them is the correct string value - then I have the code ...so how to do this? could be ez or not ez?!?</div><div><br/></div><div>To do this I need to understand what is being pushed by this code:</div><div>push offset byte_406549; lpString2</div><div>push offset String1; lpString1</div><div><br/></div><div><span style="font-weight: bold;">What this code means is:</span></div><div>The function pushes the address of the string lpString2 and lpString1 on the stack and then compares them by calling lstrcmpA - how do I find the values in IDA????</div><div><br/></div><div>Alrighty then ðŸ™‚ Found a way to get the string values - its in the data section so I need to <span style="font-weight: bold;">step into</span> the the lstrcmpA function and monitor the registers RSI and RDI</div><div><br/></div><div><br/></div><div><img src="Evernote.enex_files/Image [3].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div><span style="font-weight: bold;"><img src="Evernote.enex_files/Image [4].png" type="image/png" data-filename="Image.png"/></span></div><div><br/></div><div><img src="Evernote.enex_files/Image [5].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div><img src="Evernote.enex_files/Image [6].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div><br/></div><div><span style="font-weight: bold;">Wonder how this code is generated and if it will be different somehow if I used other input values?Â </span></div><div><br/></div><div><div><span style="font-weight: bold;">Fuzzy:</span></div><div><br/></div><div>for any user name longer than 4 characters the key decimal will always be 10 characters</div><table style="border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 189px;"></col><col style="width: 130px;"></col><col style="width: 130px;"></col></colgroup><tbody><tr><td style="width: 189px; padding: 8px; border: 1px solid;"><div><span style="font-weight: bold;">Username</span></div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div><span style="font-weight: bold;">Key Hex</span></div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div><span style="font-weight: bold;">Key Decimal</span></div></td></tr><tr><td style="width: 189px; padding: 8px; border: 1px solid;"><div>Johannes</div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div>4BF7F2EF</div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div>1274540783</div></td></tr><tr><td style="width: 189px; padding: 8px; border: 1px solid;"><div>Daniel</div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div>650A9466</div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div>1695192166</div></td></tr><tr><td style="width: 189px; padding: 8px; border: 1px solid;"><div>aaaa</div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div>0D4BA0C6F</div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div>3568962671</div></td></tr><tr><td style="width: 189px; padding: 8px; border: 1px solid;"><div>bbbb</div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div>904B45DD</div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div>2420852189</div></td></tr><tr><td style="width: 189px; padding: 8px; border: 1px solid;"><div>bbbbbbbbbbbbbbbbbbb</div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div>0B0438DB7</div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div>2957217207</div></td></tr></tbody></table><div><br/></div></div><div><span style="font-weight: bold;">Strategy:</span>Â I need to find the method that saves the user name and get to the function that transforms the username into the encoded decimalÂ </div><div>What do I know: Well I know where the offset for String 2-that offset is pushed onto the stack at some point in the program</div><div><br/></div><div><span style="font-weight: bold;">Commands in Assembly</span></div><div><br/></div><div><div><br/></div><table style="border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 130px;"></col><col style="width: 130px;"></col></colgroup><tbody><tr><td style="width: 130px; padding: 8px; border: 1px solid;"><div><span style="font-weight: bold;">Command</span></div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div><span style="font-weight: bold;">Description</span></div></td></tr><tr><td style="width: 130px; padding: 8px; border: 1px solid;"><div>GetDlgItemText</div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div>get String from textbox</div></td></tr><tr><td style="width: 130px; padding: 8px; border: 1px solid;"><div>lstrlenA</div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div>Get String Length</div></td></tr><tr><td style="width: 130px; padding: 8px; border: 1px solid;"><div>GetDlgItemTextA</div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div><br/></div></td></tr><tr><td style="width: 130px; padding: 8px; border: 1px solid;"><div>lstrcmpA</div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div>Compares if two strings match or not</div></td></tr><tr><td style="width: 130px; padding: 8px; border: 1px solid;"><div>MessageBoxA</div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div>displays a message box</div></td></tr></tbody></table><div><br/></div></div><div><br/></div><div><br/></div><div><br/></div><div><span style="font-weight: bold;">lpString</span> is the string that is generated by the program - so I need to trace this back from this function</div><div><br/></div><div>Converts the string = daniel into chars and saves in bl</div><div>the xor part is the interresting part now - so each byte in bl is xor'ed with byte_406328[eax] - this is a transformation</div><div><br/></div><div><br/></div><div><img src="Evernote.enex_files/Image [7].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div><div><br/></div><table style="border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 130px;"></col><col style="width: 130px;"></col><col style="width: 130px;"></col><col style="width: 130px;"></col><col style="width: 130px;"></col></colgroup><tbody><tr><td style="width: 130px; padding: 8px; border: 1px solid;"><div><span style="font-weight: bold;">INPUT</span></div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div><span style="font-weight: bold;">HEX</span></div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div><span style="font-weight: bold;">CL</span></div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div><span style="font-weight: bold;">XOR VALUE</span></div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div><span style="font-weight: bold;">OUTPUT</span></div></td></tr><tr><td style="width: 130px; padding: 8px; border: 1px solid;"><div>d</div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div>64</div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div><br/></div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div><br/></div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div><br/></div></td></tr><tr><td style="width: 130px; padding: 8px; border: 1px solid;"><div>a</div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div>61</div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div>61</div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div>AA</div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div>68</div></td></tr><tr><td style="width: 130px; padding: 8px; border: 1px solid;"><div>n</div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div>6E</div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div>6E</div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div>89</div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div>E7</div></td></tr><tr><td style="width: 130px; padding: 8px; border: 1px solid;"><div>i</div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div>69</div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div>65</div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div>C4</div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div>9B</div></td></tr><tr><td style="width: 130px; padding: 8px; border: 1px solid;"><div>e</div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div>65</div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div>6C</div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div>46</div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div>2A</div></td></tr><tr><td style="width: 130px; padding: 8px; border: 1px solid;"><div>l</div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div>6C</div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div>00</div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div>61</div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div>61</div></td></tr></tbody></table><div><div><br/></div><table style="border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 130px;"></col><col style="width: 130px;"></col><col style="width: 130px;"></col><col style="width: 130px;"></col><col style="width: 130px;"></col></colgroup><tbody><tr><td style="width: 130px; padding: 8px; border: 1px solid;"><div style="box-sizing: border-box; margin: 0px; padding: 0px; font-size: medium;"><span style="box-sizing: border-box; font-size: medium; color: rgb(0, 0, 0); font-family: &quot;Segoe UI&quot;; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">INPUT</span></div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div style="box-sizing: border-box; margin: 0px; padding: 0px; font-size: medium;"><span style="box-sizing: border-box; font-size: medium; color: rgb(0, 0, 0); font-family: &quot;Segoe UI&quot;; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">HEX</span></div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div style="box-sizing: border-box; margin: 0px; padding: 0px; font-size: medium;"><span style="box-sizing: border-box; font-size: medium; color: rgb(0, 0, 0); font-family: &quot;Segoe UI&quot;; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">CL</span></div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div style="box-sizing: border-box; margin: 0px; padding: 0px; font-size: medium;"><span style="box-sizing: border-box; font-size: medium; color: rgb(0, 0, 0); font-family: &quot;Segoe UI&quot;; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">XOR VALUE</span></div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div style="box-sizing: border-box; margin: 0px; padding: 0px; font-size: medium;"><span style="box-sizing: border-box; font-size: medium; color: rgb(0, 0, 0); font-family: &quot;Segoe UI&quot;; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">OUTPUT</span></div></td></tr><tr><td style="width: 130px; padding: 8px; border: 1px solid;">r</td><td style="width: 130px; padding: 8px; border: 1px solid;"><div>72</div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div><br/></div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div><br/></div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div><br/></div></td></tr><tr><td style="width: 130px; padding: 8px; border: 1px solid;"><div>o</div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div>6F</div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div><br/></div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div><br/></div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div><br/></div></td></tr><tr><td style="width: 130px; padding: 8px; border: 1px solid;"><div>b</div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div>62</div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div><br/></div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div><br/></div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div><br/></div></td></tr><tr><td style="width: 130px; padding: 8px; border: 1px solid;"><div>e</div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div>65</div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div><br/></div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div><br/></div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div><br/></div></td></tr><tr><td style="width: 130px; padding: 8px; border: 1px solid;"><div>r</div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div>72</div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div><br/></div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div><br/></div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div><br/></div></td></tr><tr><td style="width: 130px; padding: 8px; border: 1px solid;"><div>t</div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div>74</div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div><br/></div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div><br/></div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div><br/></div></td></tr><tr><td style="width: 130px; padding: 8px; border: 1px solid;"><div>o</div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div>6F</div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div><br/></div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div><br/></div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div><br/></div></td></tr><tr><td style="width: 130px; padding: 8px; border: 1px solid;"><div>s</div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div>73</div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div><br/></div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div><br/></div></td><td style="width: 130px; padding: 8px; border: 1px solid;"><div><br/></div></td></tr></tbody></table><div>Ok</div></div></div><div><br/></div><div>There is an array of chars starting with 0xAA - this is element 0</div><div><br/></div><div>So its like this in code byteArray = {AA, 89,C4, FE, 46,78,F0,D0,3,E7,F7,FD,F4,E7,B9,B5,C9,50,73,0}</div><div><br/></div><div><img src="Evernote.enex_files/Image [8].png" type="image/png" data-filename="Image.png"/></div><div><br/></div></div><div><br/></div><div><br/></div><div><span style="font-weight: bold;">This is the first set of iterations - it does the following</span></div><div><br/></div><div>Type &quot;copyright&quot;, &quot;credits&quot; or &quot;license()&quot; for more information.</div><div>&gt;&gt;&gt; hexbuffer=[]</div><div>&gt;&gt;&gt; input=&quot;danielddddd&quot;</div><div>&gt;&gt;&gt; size=len(input)</div><div>&gt;&gt;&gt; buffer=[]</div><div>&gt;&gt;&gt; chararray=list(input)</div><div>&gt;&gt;&gt; buffer.append(ord(chararray[0]))</div><div>&gt;&gt;&gt; convert = [170,137,196,254,70]</div><div>&gt;&gt;&gt; j = 0</div><div>&gt;&gt;&gt; for x in range(1, size):</div><div>Â Â Â Â if x &lt; 6:</div><div>Â Â Â Â Â Â Â Â buffer.append(ord(chararray[x]) ^ convert[j])</div><div>Â Â Â Â Â Â Â Â j = j+1</div><div>Â Â Â Â elif x &gt; 5:</div><div>Â Â Â Â Â Â Â Â j = x - 5</div><div>Â Â Â Â Â Â Â Â buffer.append(ord(chararray[x]) ^ ord(chararray[j]))</div><div><br/></div><div>Â Â Â Â Â Â Â Â </div><div>&gt;&gt;&gt; buffer</div><div>[100, 203, 231, 173, 155, 42, 5, 10, 13, 1, 8,100]</div><div><br/></div><div>&gt;&gt;&gt; hexbuffer=[]</div><div>&gt;&gt;&gt; for a in range(0, len(buffer)):</div><div>Â Â Â Â hexbuffer.append(hex(buffer[a]))</div><div>&gt;&gt;&gt; hexbuffer</div><div>['0x64', '0xcb', '0xe7', '0xad', '0x9b', '0x2a', '0x5', '0xa', '0xd', '0x1', '0x8', '0x64']</div><div><img src="Evernote.enex_files/Image [9].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div><br/></div><div><span style="font-weight: bold;">After function:</span></div><div>'0x64', '0xcb', '0xe7', '0xad', '0x9b', '0x2a', '0x5', '0xa', '0xd', '0x1', '0x8', '0x64']</div><div><br/></div><div>We can see there is an exact match here:Â </div><div><br/></div><div><img src="Evernote.enex_files/Image [10].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div><br/></div><div><span style="font-weight: bold;">Part 1 solved:Â </span></div><div><br/></div><div>name=input(&quot;Enter name to generate keygen : &quot;)</div><div>if len(name) &lt; 5:</div><div>Â Â Â Â print(&quot;Sorry the name must be longer than 4 characters&quot;)</div><div>else:</div><div>Â Â Â Â hexbuffer=[]</div><div>Â Â Â Â size=len(name)</div><div>Â Â Â Â buffer=[]</div><div>Â Â Â Â chararray=list(name)</div><div>Â Â Â Â buffer.append(ord(chararray[0]))</div><div>Â Â Â Â convert = [170,137,196,254,70]</div><div>Â Â Â Â j = 0</div><div>Â Â Â Â for x in range(1, size):</div><div>Â Â Â Â Â Â Â Â if x &lt; 6:</div><div>Â Â Â Â Â Â Â Â Â Â Â Â buffer.append(ord(chararray[x]) ^ convert[j])</div><div>Â Â Â Â Â Â Â Â Â Â Â Â j+=1</div><div>Â Â Â Â Â Â Â Â elif x &gt; 5:</div><div>Â Â Â Â Â Â Â Â Â Â Â Â j = x - 5</div><div>Â Â Â Â Â Â Â Â Â Â Â Â buffer.append(ord(chararray[x]) ^ ord(chararray[j]))</div><div>Â Â Â Â buffer.append(ord(chararray[0]))</div><div>Â Â Â Â print(buffer)</div><div><br/></div><div><br/></div><div><span style="font-weight: bold;">Encoding pass 2:</span></div><div><span style="font-weight: bold;">k = 0;</span></div><div><span style="font-weight: bold;">l = 0;</span></div><div><span style="font-weight: bold;">hexbuffer=[]</span></div><div><span style="font-weight: bold;">for y in range(len(buffer1)-1, 0,-1):</span></div><div><span style="font-weight: bold;">Â Â Â Â if y &gt; 6:</span></div><div><span style="font-weight: bold;">Â Â Â Â Â Â Â Â print(y)</span></div><div><span style="font-weight: bold;">Â Â Â Â Â Â Â Â buffer2.append(buffer1[y])</span></div><div><span style="font-weight: bold;">Â Â Â Â Â Â Â Â buffer1[y] = buffer1[y] ^ convert2[k]</span></div><div><span style="font-weight: bold;">Â Â Â Â Â Â Â Â k += 1</span></div><div><span style="font-weight: bold;">Â Â Â Â elif y &lt; 7:</span></div><div><span style="font-weight: bold;">Â Â Â Â Â Â Â Â print(y)</span></div><div><span style="font-weight: bold;">Â Â Â Â Â Â Â Â buffer2.append(buffer1[y])</span></div><div><span style="font-weight: bold;">Â Â Â Â Â Â Â Â buffer1[y] = buffer1[y] ^ buffer2[l]</span></div><div><span style="font-weight: bold;">Â Â Â Â Â Â Â Â l += 1;</span></div><div><br/></div><div><span style="font-weight: bold;">for z in range(0, len(buffer1)):</span></div><div><span style="font-weight: bold;">Â Â Â Â hexbuffer.append(hex(buffer1[z]))</span></div><div><span style="font-weight: bold;">print(hexbuffer)</span></div><div><br/></div><div><img src="Evernote.enex_files/Image [11].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div><br/></div><div>for loop</div><div>Â  Â  looping downwards from buffer[size - 1]</div><div>['0x64', '0xcb', '0xa', '0xa3', '0x4a', '0xd2', '0xe0', '0xed', '0xe', '0xd1', '0xf8', '0xe5']</div><div><span style="font-weight: bold;">64h, 0CBh, 0E7h, 0ADh, 9Bh, 2Ah, 5, 0Ah, 0Dh, 1, 8, 64hÂ </span></div><div><br/></div><div>['0x64', '0xce', '0xed', '0xa0', '0x9a', '0x22', '0x61', '0xed', '0xe', '0xd1', '0xf8', '0x1c']</div><div><span style="font-weight: bold;">64h, 0CEh, 0EDh, 0A0h, 9Ah, 22h, 61h, 0EDh, 0Eh, 0D1h, 0F8h, 1Ch, 1F3h dup(0)</span></div><div><br/></div><div><span style="font-weight: bold;">['0x64', '0x39', '0x10', '0x54', '0x7d', '0x9b', '0xaf', '0x0', '0xae', '0x4b', '0xda', '0x7d']</span></div><div><span style="font-weight: bold;">64h, 39h, 10h, 54h, 7Dh, 9Bh, 0AFh, 0, 0AEh, 4Bh, 0DAh, 7Dh,Â Â </span></div><div><br/></div><div>['0x64', '0x96', '0x10', '0xfa', '0x36', '0x41', '0xd2', '0x73', '0xfe', '0x82', '0xc1', '0xc8']</div><div><span style="font-weight: bold;">64h, 96h, 10h, 0FAh, 36h, 41h, 0D2h, 73h, 0FEh, 82h, 0C1h, 0C8h, 1F3h dup(0)</span></div><div><br/></div><div><br/></div><div><span style="font-weight: bold;">import sys</span></div><div><span style="font-weight: bold;">name=input(&quot;Enter name to generate keygen : &quot;)</span></div><div><span style="font-weight: bold;">if len(name) &lt; 5:</span></div><div><span style="font-weight: bold;">Â Â Â Â print(&quot;Sorry the name must be longer than 4 characters&quot;)</span></div><div><span style="font-weight: bold;">Â Â Â Â sys.exit(0)</span></div><div><span style="font-weight: bold;">Â Â Â Â </span></div><div><br/></div><div><span style="font-weight: bold;">hexbuffer=[]</span></div><div><span style="font-weight: bold;">size=len(name)</span></div><div><span style="font-weight: bold;">buffer1=[]</span></div><div><span style="font-weight: bold;">buffer2=[]</span></div><div><span style="font-weight: bold;">chararray=list(name)</span></div><div><span style="font-weight: bold;">buffer1.append(ord(chararray[0]))</span></div><div><span style="font-weight: bold;">convert1 = [170,137,196,254,70]</span></div><div><span style="font-weight: bold;">convert2 = [120,240,208,3,231]</span></div><div><span style="font-weight: bold;">convert3 = [247,253,244,231,185]</span></div><div><span style="font-weight: bold;">convert4 = [181,27,201,80,115]</span></div><div><span style="font-weight: bold;">j = 0</span></div><div><span style="font-weight: bold;">for x in range(1, len(chararray)):</span></div><div><span style="font-weight: bold;">Â Â Â Â if x &lt; 6:</span></div><div><span style="font-weight: bold;">Â Â Â Â Â Â Â Â buffer1.append(ord(chararray[x]) ^ convert1[j])</span></div><div><span style="font-weight: bold;">Â Â Â Â Â Â Â Â j+=1</span></div><div><span style="font-weight: bold;">Â Â Â Â elif x &gt; 5:</span></div><div><span style="font-weight: bold;">Â Â Â Â Â Â Â Â j = x - 5</span></div><div><span style="font-weight: bold;">Â Â Â Â Â Â Â Â buffer1.append(ord(chararray[x]) ^ ord(chararray[j]))</span></div><div><span style="font-weight: bold;">buffer1.append(ord(chararray[0]))</span></div><div><span style="font-weight: bold;">for z in range(0, len(buffer1)):</span></div><div><span style="font-weight: bold;">Â Â Â Â hexbuffer.append(hex(buffer1[z]))</span></div><div><span style="font-weight: bold;">k = 0;</span></div><div><span style="font-weight: bold;">l = 0;</span></div><div><span style="font-weight: bold;">hexbuffer=[]</span></div><div><span style="font-weight: bold;">for y in range(len(buffer1)-1, 0,-1):</span></div><div><span style="font-weight: bold;">Â Â Â Â if y &gt; 6:</span></div><div><span style="font-weight: bold;">Â Â Â Â Â Â Â Â buffer2.append(buffer1[y])</span></div><div><span style="font-weight: bold;">Â Â Â Â Â Â Â Â buffer1[y] = buffer1[y] ^ convert2[k]</span></div><div><span style="font-weight: bold;">Â Â Â Â Â Â Â Â k += 1</span></div><div><span style="font-weight: bold;">Â Â Â Â elif y &lt; 7:</span></div><div><span style="font-weight: bold;">Â Â Â Â Â Â Â Â buffer2.append(buffer1[y])</span></div><div><span style="font-weight: bold;">Â Â Â Â Â Â Â Â buffer1[y] = buffer1[y] ^ buffer2[l]</span></div><div><span style="font-weight: bold;">Â Â Â Â Â Â Â Â l += 1;</span></div><div><span style="font-weight: bold;">for z in range(0, len(buffer1)):</span></div><div><span style="font-weight: bold;">Â Â Â Â hexbuffer.append(hex(buffer1[z]))</span></div><div><span style="font-weight: bold;">hexbuffer=[]</span></div><div><span style="font-weight: bold;">buffer2=[]</span></div><div><span style="font-weight: bold;">j = 0</span></div><div><span style="font-weight: bold;">l = 0</span></div><div><span style="font-weight: bold;">for t in range(1, len(buffer1)):</span></div><div><span style="font-weight: bold;">Â Â Â Â if t &lt; 6:</span></div><div><span style="font-weight: bold;">Â Â Â Â Â Â Â Â buffer2.append(buffer1[t])</span></div><div><span style="font-weight: bold;">Â Â Â Â Â Â Â Â buffer1[t] = buffer1[t] ^ convert3[j]</span></div><div><span style="font-weight: bold;">Â Â Â Â Â Â Â Â j+=1</span></div><div><span style="font-weight: bold;">Â Â Â Â elif t &gt; 5:</span></div><div><span style="font-weight: bold;">Â Â Â Â Â Â Â Â buffer2.append(buffer1[t])</span></div><div><span style="font-weight: bold;">Â Â Â Â Â Â Â Â buffer1[t] = buffer1[t] ^ buffer2[l]</span></div><div><span style="font-weight: bold;">Â Â Â Â Â Â Â Â l += 1</span></div><div><span style="font-weight: bold;">for z in range(0, len(buffer1)):</span></div><div><span style="font-weight: bold;">Â Â Â Â hexbuffer.append(hex(buffer1[z]))</span></div><div><span style="font-weight: bold;">k = 0;</span></div><div><span style="font-weight: bold;">l = 0;</span></div><div><span style="font-weight: bold;">buffer2=[]</span></div><div><span style="font-weight: bold;">hexbuffer=[]</span></div><div><span style="font-weight: bold;">for y in range(len(buffer1)-1, 0,-1):</span></div><div><span style="font-weight: bold;">Â Â Â Â if y &gt; 6:</span></div><div><span style="font-weight: bold;">Â Â Â Â Â Â Â Â buffer2.append(buffer1[y])</span></div><div><span style="font-weight: bold;">Â Â Â Â Â Â Â Â buffer1[y] = buffer1[y] ^ convert4[k]</span></div><div><span style="font-weight: bold;">Â Â Â Â Â Â Â Â k += 1</span></div><div><span style="font-weight: bold;">Â Â Â Â elif y &lt; 7:</span></div><div><span style="font-weight: bold;">Â Â Â Â Â Â Â Â buffer2.append(buffer1[y])</span></div><div><span style="font-weight: bold;">Â Â Â Â Â Â Â Â buffer1[y] = buffer1[y] ^ buffer2[l]</span></div><div><span style="font-weight: bold;">Â Â Â Â Â Â Â Â l += 1;</span></div><div><span style="font-weight: bold;">for z in range(0, len(buffer1)):</span></div><div><span style="font-weight: bold;">Â Â Â Â hexbuffer.append(hex(buffer1[z]))</span></div><div><br/></div><div><br/></div><div><span style="font-weight: bold;">#Add it up</span></div><div><span style="font-weight: bold;">final = [0,0,0,0]</span></div><div><span style="font-weight: bold;">j = 0</span></div><div><span style="font-weight: bold;">for a in range(1, len(buffer1),+1):</span></div><div><span style="font-weight: bold;">Â Â Â Â final[j] = final[j] + (buffer1[a] % 256)</span></div><div><span style="font-weight: bold;">Â Â Â Â j += 1</span></div><div><span style="font-weight: bold;">Â Â Â Â if j==4:</span></div><div><span style="font-weight: bold;">Â Â Â Â Â Â Â Â j = 0</span></div><div><span style="font-weight: bold;">Â Â Â Â Â Â Â Â print(&quot;J has been reset&quot;, j)</span></div><div><br/></div><div><span style="font-weight: bold;">final.reverse()</span></div><div><span style="font-weight: bold;">hexbuffer = []</span></div><div><span style="font-weight: bold;">mainstring = ''</span></div><div><span style="font-weight: bold;">for x in range(0, len(final)):</span></div><div><span style="font-weight: bold;">Â Â Â Â final[x]=final[x]</span></div><div><span style="font-weight: bold;">Â Â Â Â hexbuffer.append(hex(final[x]))</span></div><div><span style="font-weight: bold;">Â Â Â Â mainstring = mainstring + hex(final[x])</span></div><div><span style="font-weight: bold;">Â Â Â Â mainstring = mainstring.replace('0x','')</span></div><div><span style="font-weight: bold;">print(&quot;The key is &quot;, int(mainstring, 16))</span></div><div><br/></div><div><br/></div><div><span style="font-weight: bold;"><img src="Evernote.enex_files/Image [12].png" type="image/png" data-filename="Image.png"/></span></div><div><br/></div><div><br/></div><div><span style="font-weight: bold;">IT is still a bit buggy - but I will get this done properlyÂ </span></div><div><br/></div><div>Test Input: robert</div><div><br/></div><div>D:\NextLevel\!InfoSec Institute Training\RevEngineer\crackmes\level1&gt;python keygen2.py</div><div>Enter name to generate keygen : robert</div><div>Iteration 1 ['0x72', '0xc5', '0xeb', '0xa1', '0x8c', '0x32', '0x6f']</div><div>Iteration 2 ['0x72', '0xaa', '0xc', '0xa2', '0x5c', '0xc2', '0x17']</div><div>Iteration 3 ['0x72', '0x5d', '0xf1', '0x56', '0xbb', '0x7b', '0xbd']</div><div>Iteration 4 ['0x72', '0xe0', '0x82', '0x6', '0x72', '0x60', '0x8']</div><div>The key isÂ Â 119966272</div><div><br/></div><div><br/></div><div>Iteration 1 72h, 0C5h, 0EBh, 0A1h, 8Ch, 32h, 6Fh, 1F8h dup(0)</div><div>Iteration 2 72h, 0AAh, 0Ch, 0A2h, 5Ch, 0C2h, 17h, 1F8h dup(0</div><div>Iteration 3Â 72h, 5Dh, 0F1h, 56h, 0BBh, 7Bh, 0BDh, 1F8h dup(0)</div><div>Iteration 4Â 72h, 0E0h, 82h, 6, 72h, 60h, 8, 1F8h dup(0)</div><div><br/></div><div><br/></div><div>72068A40</div><div><br/></div><div>My code is taking away a 0 that I needÂ </div><div><br/></div><div>D:\NextLevel\!InfoSec Institute Training\RevEngineer\crackmes\level1&gt;python keygen2.py</div><div>Enter name to generate keygen : robert</div><div>7268a40</div><div>The key isÂ Â 119966272</div><div><br/></div><div><br/></div><div>Patching the exe</div><div><br/></div><div><img src="Evernote.enex_files/Image [13].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div><br/></div><div><br/></div><div>No code path to rejecting the incorrect codeÂ </div><div><br/></div><div><img src="Evernote.enex_files/Image [14].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div></span>
</div></body></html> 